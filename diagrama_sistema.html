<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagrama do Sistema Rota do Mar</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 100%;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
        }
        .mermaid {
            display: flex;
            justify-content: center;
            overflow: auto;
        }
        .controls {
            margin: 20px 0;
            text-align: center;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin: 0 5px;
        }
        button:hover {
            background-color: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Diagrama do Sistema Rota do Mar</h1>
        
        <div class="controls">
            <button onclick="zoomIn()">Aumentar Zoom</button>
            <button onclick="zoomOut()">Diminuir Zoom</button>
            <button onclick="resetZoom()">Resetar Zoom</button>
        </div>
        
        <div class="mermaid" id="mermaidChart">
classDiagram
    %% Principais entidades do sistema
    class Produto {
        +int id
        +string referencia
        +string descricao
        +date data_cadastro
        +date data_prevista_producao
        +int marca_id
        +int quantidade
        +int estilista_id
        +int grupo_id
        +decimal preco_atacado
        +decimal preco_varejo
        +int status_id
        +string anexo_ficha_producao
        +string anexo_catalogo_vendas
        +getQuantidadeTotalPorCoresAttribute()
        +getDataPrevistaProducaoMesAnoAttribute()
        +getLocalizacaoAtualAttribute()
        +getConcluidoAtualAttribute()
        +getCoresDisponiveisAttribute()
    }

    class ProdutoCor {
        +int id
        +int produto_id
        +string cor
        +string codigo_cor
        +int quantidade
    }

    class ProdutoCombinacao {
        +int id
        +int produto_id
        +string descricao
        +int quantidade_pretendida
        +string observacoes
    }

    class ProdutoCombinacaoComponente {
        +int id
        +int produto_combinacao_id
        +int tecido_id
        +string cor
        +string codigo_cor
        +decimal consumo
    }

    class ProdutoAnexo {
        +int id
        +int produto_id
        +string descricao
        +string arquivo
        +string tipo
    }

    class Tecido {
        +int id
        +string descricao
        +string referencia
        +date data_cadastro
        +boolean ativo
        +datetime ultima_consulta_estoque
        +decimal quantidade_estoque
        +getNecessidadeTotalAttribute()
        +getTotalEstoquePorCoresAttribute()
    }

    class TecidoCorEstoque {
        +int id
        +int tecido_id
        +string cor
        +string codigo_cor
        +decimal quantidade
        +decimal quantidade_pretendida
        +date data_atualizacao
        +string observacoes
        +getNecessidadeAttribute()
        +getSaldoAttribute()
        +getProdutosPossiveisAttribute()
        +getProdutosComNecessidadeAttribute()
    }

    class Movimentacao {
        +int id
        +int comprometido
        +int produto_id
        +int localizacao_id
        +datetime data_entrada
        +datetime data_saida
        +datetime data_devolucao
        +int tipo_id
        +int situacao_id
        +string observacao
        +string anexo
        +boolean concluido
        +getAnexoUrlAttribute()
    }

    class User {
        +int id
        +string name
        +string email
        +string password
        +int localizacao_id
        +boolean is_admin
        +isAdmin()
        +hasPermission(string)
        +hasAnyPermission(array)
        +hasAllPermissions(array)
        +canAction(string, string)
        +canCreate(string)
        +canRead(string)
        +canUpdate(string)
        +canDelete(string)
        +saveFilters(string, array)
        +getFilters(string)
        +clearFilters(string)
    }

    class UserPermission {
        +int id
        +int user_id
        +int permission_id
        +boolean can_create
        +boolean can_read
        +boolean can_update
        +boolean can_delete
    }

    class Permission {
        +int id
        +string name
        +string display_name
        +string description
    }

    class Group {
        +int id
        +string name
        +string description
    }

    class Localizacao {
        +int id
        +string nome
        +int prazo
    }

    class Marca {
        +int id
        +string nome
    }

    class Estilista {
        +int id
        +string nome
    }

    class GrupoProduto {
        +int id
        +string nome
    }

    class Status {
        +int id
        +string nome
    }

    class Tipo {
        +int id
        +string nome
    }

    class Situacao {
        +int id
        +string nome
    }

    class UserFilter {
        +int id
        +int user_id
        +string page_type
        +json filters
        +saveFilters(int, string, array)
        +getFilters(int, string)
        +clearFilters(int, string)
    }

    class UserAccessSchedule {
        +int id
        +int user_id
        +time start_time
        +time end_time
        +boolean monday
        +boolean tuesday
        +boolean wednesday
        +boolean thursday
        +boolean friday
        +boolean saturday
        +boolean sunday
    }

    %% Relacionamentos
    Produto "1" --> "*" ProdutoCor : tem
    Produto "1" --> "*" ProdutoAnexo : tem
    Produto "1" --> "*" ProdutoCombinacao : tem
    Produto "*" --> "*" Tecido : usa
    Produto "1" --> "*" Movimentacao : tem
    Produto "*" --> "1" Marca : pertence
    Produto "*" --> "1" Estilista : criado por
    Produto "*" --> "1" GrupoProduto : pertence
    Produto "*" --> "1" Status : tem

    ProdutoCombinacao "1" --> "*" ProdutoCombinacaoComponente : tem
    ProdutoCombinacaoComponente "*" --> "1" Tecido : usa

    Tecido "1" --> "*" TecidoCorEstoque : tem

    Movimentacao "*" --> "1" Localizacao : está em
    Movimentacao "*" --> "1" Tipo : tem
    Movimentacao "*" --> "1" Situacao : tem

    User "*" --> "1" Localizacao : pertence
    User "*" --> "*" Group : pertence
    User "1" --> "*" UserPermission : tem
    User "1" --> "*" UserFilter : tem
    User "1" --> "1" UserAccessSchedule : tem

    Group "*" --> "*" Permission : tem
        </div>
    </div>

    <script>
        // Inicializa o Mermaid
        mermaid.initialize({
            startOnLoad: true,
            theme: 'default',
            securityLevel: 'loose',
            flowchart: {
                useMaxWidth: false,
                htmlLabels: true
            }
        });
        
        // Variáveis para controle de zoom
        let currentZoom = 1;
        const zoomFactor = 0.1;
        const mermaidChart = document.getElementById('mermaidChart');
        
        // Funções de zoom
        function zoomIn() {
            currentZoom += zoomFactor;
            applyZoom();
        }
        
        function zoomOut() {
            if (currentZoom > zoomFactor) {
                currentZoom -= zoomFactor;
                applyZoom();
            }
        }
        
        function resetZoom() {
            currentZoom = 1;
            applyZoom();
        }
        
        function applyZoom() {
            mermaidChart.style.transform = `scale(${currentZoom})`;
            mermaidChart.style.transformOrigin = 'top center';
        }
    </script>
</body>
</html>
